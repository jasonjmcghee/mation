var Fe=Object.defineProperty;var Ue=(t,e,r)=>e in t?Fe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var f=(t,e,r)=>(Ue(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const J=`#version 300 es
precision highp float;
precision highp int;
`,xe=`${J}
in vec2 position;
out vec2 vUv;
void main() {
    vUv = 0.5 * (position + 1.0);
    gl_Position = vec4(position, 0.0, 1.0);
}`;class Me{constructor(e,r,a){f(this,"vertexShader");f(this,"fragmentShader");f(this,"program");f(this,"quad");f(this,"name");f(this,"w");f(this,"uniforms");const{fragmentShader:n,vertexShader:s,uniforms:i,name:o}=a;this.vertexShader=s??xe,this.fragmentShader=n,this.program=e.createProgram(this.vertexShader,`${J}${this.fragmentShader}`),this.uniforms=i,this.quad=r,this.name=o||"",e.programs.set(o||"",this.program),this.w=e}updateFragmentShader(e){this.fragmentShader=e,this.program=this.w.createProgram(this.vertexShader,`${J}${this.fragmentShader}`),this.w.programs.set(this.name,this.program)}set(e){Object.keys(e).forEach(r=>{this.uniforms[r]=e[r]})}render(e){e!=null&&e.uniforms&&this.set(e.uniforms),typeof(e==null?void 0:e.renderTarget)<"u"?this.w.setRenderTarget(e.renderTarget):this.w.setRenderTarget(null),this.w.render(this.name,this.uniforms,{position:this.quad})}}class Be{constructor(e,r){f(this,"w");f(this,"quad");f(this,"passes");this.w=e,this.quad=r,this.passes={}}add(e,r={},a={}){const n=a.dpr||window.devicePixelRatio||1,s=a.scale?n:1,i=this.w,o=this.w.canvas,l=this.w.canvas.width,u=this.w.canvas.height;i.gl.viewport(0,0,o.width,o.height);const c={minFilter:i.gl.NEAREST,magFilter:i.gl.NEAREST,internalFormat:i.gl.RGBA16F,format:i.gl.RGBA,type:i.gl.HALF_FLOAT,...r},h=(a==null?void 0:a.renderTargetCount)??2,d=[];for(let p=0;p<h;p++)d.push(i.createRenderTarget(l*s,u*s,c));const m=this.createPass(e);return{canvas:o,render:p=>{m.render({uniforms:p==null?void 0:p.uniforms,renderTarget:p==null?void 0:p.renderTarget})},renderTargets:d,renderer:i,scaling:n,uniforms:m.uniforms,gl:this.gl(),stage:m}}createPass(e){const{name:r}=e,a=`pass-${Object.keys(this.passes).length}:-${r??""}`,n=new Me(this.w,this.quad,{...e,name:a});return this.passes[a]=n,n}gl(){return this.w.gl}}class Ne{constructor(e,r,a,n){f(this,"gl");f(this,"name");f(this,"texture");f(this,"framebuffer");this.gl=e,this.name=r,this.texture=a,this.framebuffer=n}updateFilters({minFilter:e,magFilter:r}){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,r),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}}class $e{constructor(e,r){f(this,"canvas");f(this,"gl");f(this,"programs");f(this,"framebuffers");f(this,"defaultRenderTargetProps");f(this,"renderTargets");this.canvas=e;const a=(r==null?void 0:r.dpr)??(window.devicePixelRatio||1),n=(r==null?void 0:r.canvasScale)??1/a,s=e.width,i=e.height;"style"in e&&(e.style.width=`${s*n}px`,e.style.height=`${i*n}px`);const o=e.getContext("webgl2",{antialiasing:!1,alpha:!1});if(!o)throw new Error("WebGL2 not supported");this.gl=o,this.gl.getExtension("EXT_color_buffer_float"),this.gl.getExtension("EXT_color_buffer_half_float"),this.gl.getExtension("OES_texture_float_linear"),this.gl.disable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.BLEND),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.clearDepth(1),this.gl.colorMask(!0,!0,!0,!0),this.programs=new Map,this.framebuffers=new Map,this.defaultRenderTargetProps={minFilter:this.gl.NEAREST,magFilter:this.gl.NEAREST,internalFormat:this.gl.RGBA16F,format:this.gl.RGBA,type:this.gl.HALF_FLOAT},this.renderTargets={}}createProgram(e,r){const a=this.createShader(this.gl.VERTEX_SHADER,e),n=this.createShader(this.gl.FRAGMENT_SHADER,r),s=this.gl.createProgram();if(!s)throw new Error("Failed to create WebGL program");if(this.gl.attachShader(s,a),this.gl.attachShader(s,n),this.gl.linkProgram(s),!this.gl.getProgramParameter(s,this.gl.LINK_STATUS))throw new Error("Unable to initialize the shader program: "+this.gl.getProgramInfoLog(s));return s}addLineNumbers(e){return e.split(`
`).map((r,a)=>`${a+1}: ${r}`).join(`
`)}createShader(e,r){const a=this.gl.createShader(e);if(!a)throw new Error("Failed to create WebGL shader");if(this.gl.shaderSource(a,r),this.gl.compileShader(a),!this.gl.getShaderParameter(a,this.gl.COMPILE_STATUS))throw new Error("An error occurred compiling the shaders: "+this.gl.getShaderInfoLog(a)+`
${this.addLineNumbers(r)}`);return a}createTextureFromImage(e,r){const n=this.gl.createTexture();if(!n)throw new Error("Failed to create WebGL texture");const s=new Image;s.src=e;const i=this;return s.onload=function(){const o=document.createElement("canvas");o.width=s.width,o.height=s.height;const l=o.getContext("2d");if(!l)throw new Error("Failed to get 2D context");l.drawImage(s,0,s.height),i.createTextureFromCanvas(o),r&&r()},n}createTextureFromCanvas(e){const r=this.gl,a=r.createTexture();if(!a)throw new Error("Failed to create WebGL texture");if(!e.getContext("2d"))throw new Error("Failed to get 2D context");return r.bindTexture(r.TEXTURE_2D,a),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.bindTexture(r.TEXTURE_2D,null),a}createRenderTarget(e,r,a={},n){const{minFilter:s,magFilter:i,internalFormat:o,format:l,type:u}={...this.defaultRenderTargetProps,...a},c=n??`rt-${Object.keys(this.renderTargets).length}`,h=this.gl.createFramebuffer();if(!h)throw new Error("Failed to create framebuffer");this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,h);const d=this.gl.createTexture();if(!d)throw new Error("Failed to create texture");this.gl.bindTexture(this.gl.TEXTURE_2D,d),this.gl.texImage2D(this.gl.TEXTURE_2D,0,o,e,r,0,l,u,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,s),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,i),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,d,0);const m=this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER);if(m!==this.gl.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete: "+m);return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.framebuffers.set(c,{framebuffer:h,texture:d,width:e,height:r}),this.renderTargets[c]=new Ne(this.gl,c,d,h),this.renderTargets[c]}setRenderTargetInternal(e){if(e===null)this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);else{const r=this.framebuffers.get(e);if(!r)throw new Error(`Render target "${e}" not found`);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,r.framebuffer),this.gl.viewport(0,0,r.width,r.height)}}setRenderTarget(e){return this.setRenderTargetInternal((e==null?void 0:e.name)??null)}clear(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)}getRenderTargetTexture(e){const r=this.framebuffers.get(e);if(!r)throw new Error(`Render target "${e}" not found`);return r.texture}setUniform(e,r,a,n,s,i){const o=e.getUniformLocation(n,s);if(o===null)return;let l=null;for(let d=0;d<a;d++){const m=e.getActiveUniform(n,d);if(m&&m.name===s){l=m;break}}if(!l){console.warn(`Unable to find uniform info for "${s}"`);return}const{type:u,size:c}=l;function h(d,m){return d instanceof m?d:new m(d)}switch(u){case e.FLOAT:e.uniform1f(o,i);break;case e.INT:case e.BOOL:e.uniform1i(o,i);break;case e.FLOAT_VEC2:e.uniform2fv(o,h(i,Float32Array));break;case e.FLOAT_VEC3:e.uniform3fv(o,h(i,Float32Array));break;case e.FLOAT_VEC4:e.uniform4fv(o,h(i,Float32Array));break;case e.INT_VEC2:case e.BOOL_VEC2:e.uniform2iv(o,h(i,Int32Array));break;case e.INT_VEC3:case e.BOOL_VEC3:e.uniform3iv(o,h(i,Int32Array));break;case e.INT_VEC4:case e.BOOL_VEC4:e.uniform4iv(o,h(i,Int32Array));break;case e.FLOAT_MAT2:e.uniformMatrix2fv(o,!1,h(i,Float32Array));break;case e.FLOAT_MAT3:e.uniformMatrix3fv(o,!1,h(i,Float32Array));break;case e.FLOAT_MAT4:e.uniformMatrix4fv(o,!1,h(i,Float32Array));break;case e.SAMPLER_2D:case e.SAMPLER_CUBE:const d=r.length;this.gl.activeTexture(this.gl.TEXTURE0+d),r.push(d),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(o,d),i!=null&&this.gl.generateMipmap(this.gl.TEXTURE_2D);break;default:u===e.FLOAT&&c>1?e.uniform1fv(o,h(i,Float32Array)):(u===e.INT||u===e.BOOL)&&c>1?e.uniform1iv(o,h(i,Int32Array)):console.warn(`Unsupported uniform type: ${u}`);break}}render(e,r={},a={}){const n=this.programs.get(e);if(!n)throw new Error(`Program "${e}" not found`);this.gl.useProgram(n);const s=[],i=this.gl.getProgramParameter(n,this.gl.ACTIVE_UNIFORMS);for(const[o,l]of Object.entries(r))this.setUniform(this.gl,s,i,n,o,l);for(const[o,l]of Object.entries(a)){const u=this.gl.getAttribLocation(n,o);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,l.buffer),this.gl.enableVertexAttribArray(u),this.gl.vertexAttribPointer(u,l.size,this.gl.FLOAT,!1,0,0)}this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}createFullscreenQuad(){const e=this.gl.createBuffer();if(!e)throw new Error("Failed to create buffer");return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.gl.STATIC_DRAW),{buffer:e,size:2}}createPipeline(){const e=this.createFullscreenQuad();return new Be(this,e)}}function ee(t){return new $e(t).createPipeline()}const Ve={fragmentShader:`in vec2 vUv;
out vec4 fragColor;
uniform sampler2D u_texture;
uniform float u_progress;

void main() {
  fragColor = texture(u_texture, vUv);
}`,uniforms:{u_texture:null,u_progress:0}},$=class ${constructor({canvas:e,width:r,height:a}){f(this,"canvas");f(this,"ctx");f(this,"width");f(this,"height");f(this,"animationId",null);f(this,"texturePipelineResult");f(this,"layers",[]);f(this,"layerLookup",{});f(this,"layerInitialProperties",{});f(this,"layerCanvases",{});f(this,"layerElements",{});f(this,"defaultLayerElements",[]);f(this,"defaultLayerCanvas");f(this,"onFrame");f(this,"textureCache",{});f(this,"animationSegments",[]);f(this,"isPlaying",!0);f(this,"currentTime",0);f(this,"totalDuration",0);f(this,"lastRenderTime",0);f(this,"forceDefaultLayerOnly",!1);this.canvas=e,this.canvas.width=r,this.canvas.height=a,this.width=r,this.height=a;const{ctx:n,texturePipelineResult:s,defaultLayerCanvas:i}=this.initialize();this.ctx=n,this.texturePipelineResult=s,this.defaultLayerCanvas=i}initialize(){const e=new OffscreenCanvas(this.width,this.height);e.width=this.width,e.height=this.height;const r=e.getContext("2d");if(!r)throw new Error("Failed to get 2D context");this.ctx=r;const a=ee(this.canvas);return this.texturePipelineResult=a.add(Ve),this.defaultLayerCanvas=new OffscreenCanvas(this.canvas.width,this.canvas.height),this.setupLayers(),this.restorePlayerState(),{ctx:r,texturePipelineResult:this.texturePipelineResult,defaultLayerCanvas:this.defaultLayerCanvas}}insertLayer(e,r){this.layerInitialProperties[r.name]={...r},this.layerLookup[r.name]=r,this.layers.splice(e,0,r),this.layerElements[r.name]=[];const a=r.width??this.canvas.width,n=r.height??this.canvas.height;this.layerCanvases[r.name]=new OffscreenCanvas(a,n)}pushLayer(e){this.layerInitialProperties[e.name]={...e},this.layerLookup[e.name]=e,this.layers.push(e),this.layerElements[e.name]=[];const r=this.canvas.width,a=this.canvas.height;this.layerCanvases[e.name]=new OffscreenCanvas(r,a)}registerElement(e){if(e.layer)if(Array.isArray(e.layer))for(const r of e.layer)this.layerLookup[r]&&this.layerElements[r].push(e);else this.layerLookup[e.layer]?this.layerElements[e.layer].push(e):this.defaultLayerElements.push(e);else this.defaultLayerElements.push(e)}clear(){this.texturePipelineResult.renderer.clear(),this.defaultLayerCanvas.getContext("2d").clearRect(0,0,this.defaultLayerCanvas.width,this.defaultLayerCanvas.height);for(const r in this.layerCanvases)this.layerCanvases[r].getContext("2d").clearRect(0,0,this.layerCanvases[r].width,this.layerCanvases[r].height)}getTextureForCanvas(e){const r=e===this.defaultLayerCanvas?"default":e.toString();if(!this.textureCache[r])this.textureCache[r]=this.texturePipelineResult.renderer.createTextureFromCanvas(e);else{const a=this.texturePipelineResult.gl;a.bindTexture(a.TEXTURE_2D,this.textureCache[r]),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,e),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1)}return this.textureCache[r]}reset(){this.clear(),this.animationSegments=[],this.defaultLayerElements=[];for(const r in this.layerElements)this.layerElements[r]=[];this.currentTime=0,this.totalDuration=0;const e=this.texturePipelineResult.gl;for(const r in this.textureCache)e.deleteTexture(this.textureCache[r]);this.textureCache={},this.clearPlayerState()}savePlayerState(){const e={currentTime:this.currentTime,isPlaying:this.isPlaying,totalDuration:this.totalDuration};try{localStorage.setItem($.PLAYER_STATE_KEY,JSON.stringify(e))}catch(r){console.warn("Failed to save player state:",r)}}restorePlayerState(){try{const e=localStorage.getItem($.PLAYER_STATE_KEY);if(e){const r=JSON.parse(e);console.log("Found saved state:",r),r.isPlaying!==void 0&&(this.isPlaying=r.isPlaying,console.log(`Restored playing state: ${this.isPlaying}`)),r.currentTime!==void 0&&(this.currentTime=r.currentTime,console.log(`Stored time for later restoration: ${this.currentTime}`))}else console.log("No saved player state found")}catch(e){console.warn("Failed to restore player state:",e)}}clearPlayerState(){try{localStorage.removeItem($.PLAYER_STATE_KEY)}catch(e){console.warn("Failed to clear player state:",e)}}apply(e){e(this.ctx)}setupLayers(){}*animationSequence(){}async runSequence(){this.clear();const e=this.totalDuration,r=this.currentTime,a=this.isPlaying,n=this.currentTime;if(this.currentTime=0,this.totalDuration=0,this.animationSegments=[],this.lastRenderTime=0,await this.buildAnimationTimeline(),r>0||n>0){const s=Math.max(r,n);e!==this.totalDuration&&s>this.totalDuration?this.currentTime=s>=e?this.totalDuration:0:this.currentTime=Math.min(s,this.totalDuration)}return this.isPlaying=a,this.renderAtTime(this.currentTime),this.isPlaying&&(this.lastRenderTime=performance.now(),this.startAnimationLoop()),this.savePlayerState(),Promise.resolve()}async buildAnimationTimeline(){this.ctx.save();const e=this.animationSequence();let r=e.next();for(;!r.done;)await r.value,r=e.next();this.ctx.restore(),console.log(`Animation timeline built with ${this.animationSegments.length} segments, total duration: ${this.totalDuration}s`)}play(){this.isPlaying||(this.currentTime>=this.totalDuration&&(this.currentTime=0),this.isPlaying=!0,this.lastRenderTime=performance.now(),this.startAnimationLoop(),this.savePlayerState())}pause(){this.isPlaying&&(this.isPlaying=!1,this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.savePlayerState())}playing(){return this.isPlaying}togglePlayPause(){this.isPlaying?this.pause():this.play()}getDuration(){return this.totalDuration}getCurrentTime(){return this.currentTime}startAnimationLoop(){this.animationId&&cancelAnimationFrame(this.animationId);const e=r=>{if(!this.isPlaying)return;const a=(r-this.lastRenderTime)/1e3;this.lastRenderTime=r;const n=this.currentTime;if(this.currentTime=Math.min(this.currentTime+a,this.totalDuration),this.renderAtTime(this.currentTime),this.savePlayerState(),this.onFrame&&this.onFrame(),this.currentTime>=this.totalDuration){this.isPlaying=!1,n<this.totalDuration&&this.renderAtTime(this.totalDuration),this.savePlayerState();return}this.animationId=requestAnimationFrame(e)};this.lastRenderTime=performance.now(),this.animationId=requestAnimationFrame(e)}renderAtTime(e){const r=Math.max(0,Math.min(e,this.totalDuration));this.currentTime=r,this.clear();const a=this.animationSegments.filter(s=>s.startTime<=r);a.sort((s,i)=>s.startTime-i.startTime);const n=new Map;for(const s of a){const i=r-s.startTime;let o;i>=s.duration?o=1:(o=Math.max(0,Math.min(i/s.duration,1)),o=s.easing(o));for(const l of s.elements)n.set(l,o)}this.renderFrame(n)}seekToTime(e){const r=Math.max(0,Math.min(e,this.totalDuration));this.currentTime=r,this.lastRenderTime=performance.now(),this.renderAtTime(r),r>=this.totalDuration&&(this.isPlaying=!1),this.savePlayerState()}setForceDefaultLayerOnly(e){this.forceDefaultLayerOnly!==e&&(this.forceDefaultLayerOnly=e,this.renderAtTime(this.currentTime))}getForceDefaultLayerOnly(){return this.forceDefaultLayerOnly}animate(e,r){return new Promise(a=>{const n=this.currentTime,s=r.delay||0,i=n+s,o=r.duration;for(const u of e)u.segmentStartTime=i,this.registerElement(u);const l={startTime:i,duration:o,elements:[...e],easing:r.easing||(u=>u)};this.animationSegments.push(l),this.totalDuration=Math.max(this.totalDuration,i+o),this.currentTime=i+o,a()})}renderElement(e,r,a){e.update&&e.update(a),e.draw(r,a,{layers:this.layerLookup})}renderFrame(e){const r=this.currentTime,a=this.defaultLayerCanvas.getContext("2d");a.clearRect(0,0,this.defaultLayerCanvas.width,this.defaultLayerCanvas.height),Object.keys(this.layerInitialProperties).forEach(i=>{const o=this.layerInitialProperties[i];if(o){const l=this.layerLookup[i];Object.assign(l,o)}});for(const i of this.defaultLayerElements){if(i.segmentStartTime!==void 0&&i.segmentStartTime>r)continue;const o=e.has(i)?e.get(i):1;this.renderElement(i,a,o)}for(const i in this.layerElements){const o=this.layerLookup[i];if(this.forceDefaultLayerOnly&&!o.renderWhenScrubbing){const l=this.layerElements[i];for(const u of l){if(u.segmentStartTime!==void 0&&u.segmentStartTime>r)continue;const c=e.has(u)?e.get(u):1;this.renderElement(u,a,c)}}}const n=this.getTextureForCanvas(this.defaultLayerCanvas);this.texturePipelineResult.stage.set({u_texture:n,u_progress:1}),this.texturePipelineResult.renderer.setRenderTarget(null);const s=this.texturePipelineResult.gl;s.disable(s.SCISSOR_TEST),this.texturePipelineResult.render();for(const i of this.layers)if(!this.forceDefaultLayerOnly||i.renderWhenScrubbing){const o=this.layerCanvases[i.name],l=o.getContext("2d");l.clearRect(0,0,o.width,o.height),l.save();const u=i.x??0,c=i.y??0,h=i.width??this.canvas.width,d=i.height??this.canvas.height;if(!i.isSubview){const _=h/o.width,A=d/o.height;l.translate(u,c),l.scale(_,A)}const m=this.layerElements[i.name];for(const _ of m){if(_.segmentStartTime!==void 0&&_.segmentStartTime>r)continue;const A=e.has(_)?e.get(_):1;this.renderElement(_,l,A)}l.restore();const p=this.getTextureForCanvas(o),g=this.texturePipelineResult.gl;g.enable(g.BLEND),g.blendFunc(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA),g.enable(g.SCISSOR_TEST),g.scissor(u,this.canvas.height-c-d,h,d),i.render(p,1),g.disable(g.BLEND),g.disable(g.SCISSOR_TEST)}}};f($,"PLAYER_STATE_KEY","mation_player_state");let te=$;var ae={},ie={},z={},se={},C={};Object.defineProperty(C,"__esModule",{value:!0});C._=void 0;C.SPACE=" ";C.FILL="fill";C.NONE="none";C.DRAW_LINE_VERTICAL="V";C.DRAW_LINE_HORIZONTAL="H";C.DRAW_LINE="L";C.CLOSE_PATH="Z";C.MOVE_CURSOR="M";C.DRAW_CURVE_CUBIC_BEZIER="C";C.DRAW_CURVE_SMOOTH="S";C.DRAW_CURVE_QUADRATIC="Q";C.DRAW_CURVE_QUADRATIC_CONTINUATION="T";C.DRAW_ARC="A";var ne={};Object.defineProperty(ne,"__esModule",{value:!0});function We(t){return typeof t=="string"}ne.isString=We;var I={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Math;t.abs=e.abs,t.min=e.min,t.max=e.max,t.floor=e.floor,t.round=e.round,t.sqrt=e.sqrt,t.pow=e.pow,t.cos=e.cos,t.asin=e.asin,t.sin=e.sin,t.tan=e.tan,t.PI=e.PI,t.QUADRATIC_RATIO=2/3,t.EPSILON=t.pow(2,-52)})(I);Object.defineProperty(se,"__esModule",{value:!0});var Y=C,je=ne,ke=I;function Ge(t,e){if(e===void 0&&(e=ke.round),je.isString(t))return t;for(var r=[],a=0;a<t.length;a++){var n=t[a];r.push(Y.MOVE_CURSOR,e(n[0]),e(n[1]),Y.DRAW_CURVE_CUBIC_BEZIER);for(var s=void 0,i=2;i<n.length;i+=6){var o=e(n[i]),l=e(n[i+1]),u=e(n[i+2]),c=e(n[i+3]),h=e(n[i+4]),d=e(n[i+5]),m=o==h&&u==h&&l==d&&c==d;(!m||s!=(s=""+o+l+u+c+h+d))&&r.push(o,l,u,c,h,d)}}return r.join(Y.SPACE)}se.renderPath=Ge;var V={};Object.defineProperty(V,"__esModule",{value:!0});var ze=C;function Xe(){throw new Error(Array.prototype.join.call(arguments,ze.SPACE))}V.raiseError=Xe;var oe={},le={},W={},ue={};Object.defineProperty(ue,"__esModule",{value:!0});var qe=typeof window<"u"&&window.navigator.userAgent;ue.isEdge=/(MSIE |Trident\/|Edge\/)/i.test(qe);Object.defineProperty(W,"__esModule",{value:!0});var Qe=ue,He=Qe.isEdge?Array:Float32Array;function Ye(t){return new He(t)}W.createNumberArray=Ye;var X={};Object.defineProperty(X,"__esModule",{value:!0});var k=I;function Ke(t){for(var e=t[0],r=t[1],a=r,n=e,s=2;s<t.length;s+=6){var i=t[s+4],o=t[s+5];e=k.min(e,i),n=k.max(n,i),r=k.min(r,o),a=k.max(a,o)}return{x:e,w:n-e,y:r,h:a-r}}function Ze(t,e,r){var a=Ke(r);return{x:a.x+a.w*t,y:a.y+a.h*e}}X.computeAbsoluteOrigin=Ze;Object.defineProperty(le,"__esModule",{value:!0});var Je=W,et=X;function we(t,e,r){var a=t.length,n=e.length;if(a<n)return we(e,t,r);e.length=a;for(var s=n;s<a;s++){var i=t[s],o=r.x,l=r.y;if(!r.absolute){var u=et.computeAbsoluteOrigin(o,l,i);o=u.x,l=u.y}for(var c=Je.createNumberArray(i.length),h=0;h<i.length;h+=2)c[h]=o,c[h+1]=l;e[s]=c}}le.fillSegments=we;var he={},ce={};Object.defineProperty(ce,"__esModule",{value:!0});var tt=W;function rt(t,e){var r=t.length,a=r-e,n=tt.createNumberArray(e),s;for(s=0;s<e;s++)n[s]=t[s];for(s=e;s<r;s++)t[s-e]=t[s];for(s=0;s<e;s++)t[a+s]=n[s]}ce.rotatePoints=rt;var q={};Object.defineProperty(q,"__esModule",{value:!0});var at=I;function it(t,e,r,a){return at.sqrt((t-r)*(t-r)+(e-a)*(e-a))}q.distance=it;Object.defineProperty(he,"__esModule",{value:!0});var st=ce,nt=C,ot=q,lt=X;function ut(t,e,r,a){var n=a.length;if(!(a[n-2]!==a[0]||a[n-1]!==a[1])){if(!t){var s=lt.computeAbsoluteOrigin(e,r,a);e=s.x,r=s.y}var i=a.slice(2);n=i.length;for(var o,l,u=0;u<n;u+=6){var c=ot.distance(e,e,i[u],i[u+1]);(l===nt._||c<l)&&(l=c,o=u)}st.rotatePoints(i,o),a[0]=i[n-2],a[1]=i[n-1];for(var u=0;u<i.length;u++)a[u+2]=i[u]}}he.normalizePoints=ut;var Q={};Object.defineProperty(Q,"__esModule",{value:!0});var ht=I,ct=W;function ft(t,e){for(var r=t[0].length,a=0;a<r;a++){var n=t[0][a],s=t[1][a],i=ht.max(n.length+e,s.length+e);t[0][a]=re(n,i),t[1][a]=re(s,i)}}Q.fillPoints=ft;function re(t,e){var r=e-t.length,a=Math.ceil(e/t.length),n=ct.createNumberArray(e);n[0]=t[0],n[1]=t[1];for(var s=1,i=1;i<e-1;){n[++i]=t[++s],n[++i]=t[++s],n[++i]=t[++s],n[++i]=t[++s];var o=n[++i]=t[++s],l=n[++i]=t[++s];if(r)for(var u=0;u<a&&r;u++)n[i+5]=n[i+3]=n[i+1]=o,n[i+6]=n[i+4]=n[i+2]=l,i+=6,r-=6}return n}Q.fillSubpath=re;var fe={},de={};Object.defineProperty(de,"__esModule",{value:!0});var dt=I,gt=q;function mt(t){for(var e=t.length,r=t[e-2],a=t[e-1],n=0,s=0;s<e;s+=6)n+=gt.distance(t[s],t[s+1],r,a),r=t[s],a=t[s+1];return dt.floor(n)}de.perimeterPoints=mt;Object.defineProperty(fe,"__esModule",{value:!0});var vt=de;function pt(t){return t.map(function(e){return{points:e,perimeter:vt.perimeterPoints(e)}}).sort(function(e,r){return r.perimeter-e.perimeter}).map(function(e){return e.points})}fe.getSortedSegments=pt;Object.defineProperty(oe,"__esModule",{value:!0});var Tt=le,Ce=he,yt=Q,K=C,_t=V,Ee=fe;function Ct(t,e,r){r.optimize===K.FILL&&(t=Ee.getSortedSegments(t),e=Ee.getSortedSegments(e)),t.length!==e.length&&(r.optimize===K.FILL?Tt.fillSegments(t,e,r.origin):_t.raiseError("optimize:none requires equal lengths"));var a=Array(2);if(a[0]=t,a[1]=e,r.optimize===K.FILL){for(var n=r.origin,s=n.x,i=n.y,o=n.absolute,l=0;l<t.length;l++)Ce.normalizePoints(o,s,i,a[0][l]),Ce.normalizePoints(o,s,i,a[1][l]);yt.fillPoints(a,r.addPoints*6)}return a}oe.normalizePaths=Ct;var ge={};Object.defineProperty(ge,"__esModule",{value:!0});function Et(t,e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r]);return t}ge.fillObject=Et;Object.defineProperty(z,"__esModule",{value:!0});var Pt=se,N=I,At=V,Rt=oe,bt=ge,St=W,De=C,wt={addPoints:0,optimize:De.FILL,origin:{x:0,y:0},precision:0};function Dt(t,e){e=bt.fillObject(e,wt),(!t||t.length<2)&&At.raiseError("invalid arguments");for(var r=t.length-1,a=Array(r),n=0;n<r;n++)a[n]=Ot(t[n],t[n+1],e);var s=e.precision?function(i){return i.toFixed(e.precision)}:De._;return function(i){var o=r*i,l=N.min(N.floor(o),r-1);return Pt.renderPath(a[l]((o-l)/(l+1)),s)}}z.interpolatePath=Dt;function Ot(t,e,r){var a=Rt.normalizePaths(t.getData(),e.getData(),r),n=a[0].length;return function(s){if(N.abs(s-0)<N.EPSILON)return t.getStringData();if(N.abs(s-1)<N.EPSILON)return e.getStringData();for(var i=Array(n),o=0;o<n;o++)i[o]=Oe(a[0][o],a[1][o],s);return i}}function Oe(t,e,r){for(var a=t.length,n=St.createNumberArray(a),s=0;s<a;s++)n[s]=t[s]+(e[s]-t[s])*r;return n}z.mixPoints=Oe;var H={},me={},ve={},pe={};Object.defineProperty(pe,"__esModule",{value:!0});var Lt=C;function It(t,e){return t===Lt._?e:t}pe.coalesce=It;var Te={};Object.defineProperty(Te,"__esModule",{value:!0});var P=I,Pe=P.PI*120/180,G=P.PI*2;function Le(t,e,r,a,n,s,i,o,l,u,c,h,d){if(r<=0||a<=0)return[t,e,o,l,o,l];var m=P.PI/180*(+n||0),p=P.cos(m),g=P.sin(m),_=!!u;if(!_){var A=t,O=o;t=A*p-e*-g,e=A*-g+e*p,o=O*p-l*-g,l=O*-g+l*p;var T=(t-o)/2,S=(e-l)/2,R=T*T/(r*r)+S*S/(a*a);R>1&&(R=P.sqrt(R),r=R*r,a=R*a);var b=(s===i?-1:1)*P.sqrt(P.abs((r*r*a*a-r*r*S*S-a*a*T*T)/(r*r*S*S+a*a*T*T)));h=b*r*S/a+(t+o)/2,d=b*-a*T/r+(e+l)/2,u=P.asin((e-d)/a),c=P.asin((l-d)/a),t<h&&(u=P.PI-u),o<h&&(c=P.PI-c),u<0&&(u+=G),c<0&&(c+=G),i&&u>c&&(u-=G),!i&&c>u&&(c-=G)}var E;if(P.abs(c-u)>Pe){var y=c,w=o,D=l;c=u+Pe*(i&&c>u?1:-1),o=h+r*P.cos(c),l=d+a*P.sin(c),E=Le(o,l,r,a,n,0,i,w,D,c,y,h,d)}else E=[];var L=4/3*P.tan((c-u)/4);if(E.splice(0,0,2*t-(t+L*r*P.sin(u)),2*e-(e-L*a*P.cos(u)),o+L*r*P.sin(c),l-L*a*P.cos(c),o,l),!_)for(var x=0,Ie=E.length;x<Ie;x+=2){var ye=E[x],_e=E[x+1];E[x]=ye*p-_e*g,E[x+1]=ye*g+_e*p}return E}Te.arcToCurve=Le;Object.defineProperty(ve,"__esModule",{value:!0});var v=C,M=pe,Ft=V,U=I,Ut=Te,xt={M:2,H:1,V:1,L:2,Z:0,C:6,S:4,Q:4,T:2,A:7};function F(t,e,r,a,n,s,i){var o=t.x,l=t.y;t.x=M.coalesce(s,o),t.y=M.coalesce(i,l),t.current.push(M.coalesce(e,o),r=M.coalesce(r,l),a=M.coalesce(a,o),n=M.coalesce(n,l),t.x,t.y),t.lc=t.c}function Mt(t){var e=t.c,r=t.t,a=t.x,n=t.y;if(e===v.DRAW_LINE_VERTICAL)r[0]+=n;else if(e===v.DRAW_LINE_HORIZONTAL)r[0]+=a;else if(e===v.DRAW_ARC)r[5]+=a,r[6]+=n;else for(var s=0;s<r.length;s+=2)r[s]+=a,r[s+1]+=n}function Bt(t){return t.replace(/[\^\s]*([mhvlzcsqta]|\-?\d*\.?\d+)[,\$\s]*/gi," $1").replace(/([mhvlzcsqta])/gi," $1").trim().split("  ").map(Nt)}function Nt(t){return t.split(v.SPACE).map($t)}function $t(t,e){return e===0?t:+t}function Vt(t){for(var e={x:0,y:0,segments:[]},r=Bt(t),a=0;a<r.length;a++){var n=r[a],s=n[0],i=s.toUpperCase(),o=i!==v.CLOSE_PATH&&i!==s;e.c=i;var l=xt[i],u=n,c=1;do{e.t=u.length===1?u:u.slice(c,c+l),o&&Mt(e);var h=e.t,d=e.x,m=e.y,p=void 0,g=void 0,_=void 0,A=void 0,O=void 0,T=void 0;if(i===v.MOVE_CURSOR)e.segments.push(e.current=[e.x=h[0],e.y=h[1]]);else if(i===v.DRAW_LINE_HORIZONTAL)F(e,v._,v._,v._,v._,h[0],v._);else if(i===v.DRAW_LINE_VERTICAL)F(e,v._,v._,v._,v._,v._,h[0]);else if(i===v.DRAW_LINE)F(e,v._,v._,v._,v._,h[0],h[1]);else if(i===v.CLOSE_PATH)F(e,v._,v._,v._,v._,e.current[0],e.current[1]);else if(i===v.DRAW_CURVE_CUBIC_BEZIER)F(e,h[0],h[1],h[2],h[3],h[4],h[5]),e.cx=h[2],e.cy=h[3];else if(i===v.DRAW_CURVE_SMOOTH){var S=e.lc!==v.DRAW_CURVE_SMOOTH&&e.lc!==v.DRAW_CURVE_CUBIC_BEZIER;p=S?v._:d*2-e.cx,g=S?v._:m*2-e.cy,F(e,p,g,h[0],h[1],h[2],h[3]),e.cx=h[0],e.cy=h[1]}else if(i===v.DRAW_CURVE_QUADRATIC){var R=h[0],b=h[1];_=h[2],A=h[3],F(e,d+(R-d)*U.QUADRATIC_RATIO,m+(b-m)*U.QUADRATIC_RATIO,_+(R-_)*U.QUADRATIC_RATIO,A+(b-A)*U.QUADRATIC_RATIO,_,A),e.cx=R,e.cy=b}else if(i===v.DRAW_CURVE_QUADRATIC_CONTINUATION)_=h[0],A=h[1],e.lc===v.DRAW_CURVE_QUADRATIC||e.lc===v.DRAW_CURVE_QUADRATIC_CONTINUATION?(p=d+(d*2-e.cx-d)*U.QUADRATIC_RATIO,g=m+(m*2-e.cy-m)*U.QUADRATIC_RATIO,O=_+(d*2-e.cx-_)*U.QUADRATIC_RATIO,T=A+(m*2-e.cy-A)*U.QUADRATIC_RATIO):(p=O=d,g=T=m),F(e,p,g,O,T,_,A),e.cx=O,e.cy=T;else if(i===v.DRAW_ARC)for(var E=Ut.arcToCurve(d,m,h[0],h[1],h[2],h[3],h[4],h[5],h[6]),y=0;y<E.length;y+=6)F(e,E[y],E[y+1],E[y+2],E[y+3],E[y+4],E[y+5]);else Ft.raiseError(e.c," is not supported");c+=l}while(c<u.length)}return e.segments}ve.parsePoints=Vt;Object.defineProperty(me,"__esModule",{value:!0});var Wt=V,Ae=ve,jt=C,kt=/^([#|\.]|path)/i;function Gt(t){if(Array.isArray(t))return{data:t,stringData:jt._};var e;if(typeof t=="string"&&kt.test(t)?t=document.querySelector(t):e=t,typeof t=="string")return{data:Ae.parsePoints(t),stringData:e};var r=t;return r.tagName.toUpperCase()==="PATH"?(e=r.getAttribute("d"),{data:Ae.parsePoints(e),stringData:e}):Wt.raiseError("Unsupported element ",r.tagName)}me.convertToPathData=Gt;Object.defineProperty(H,"__esModule",{value:!0});var zt=me,Xt=I,Z=C,qt=function(){function t(e){var r=zt.convertToPathData(e),a=r.data,n=r.stringData;this.data=a,this.stringData=n}return t.prototype.getData=function(){return this.data},t.prototype.getStringData=function(){return this.stringData||(this.stringData=this.render())},t.prototype.render=function(e){e===void 0&&(e=Xt.round);for(var r=this.data,a=[],n=0;n<r.length;n++){var s=r[n];a.push(Z.MOVE_CURSOR,e(s[0]),e(s[1]),Z.DRAW_CURVE_CUBIC_BEZIER);for(var i=void 0,o=2;o<s.length;o+=6){var l=e(s[o]),u=e(s[o+1]),c=e(s[o+2]),h=e(s[o+3]),d=e(s[o+4]),m=e(s[o+5]),p=l==d&&c==d&&u==m&&h==m;(!p||i!=(i=""+l+u+c+h+d+m))&&a.push(l,u,c,h,d,m)}}return a.join(Z.SPACE)},t}();H.Path=qt;Object.defineProperty(ie,"__esModule",{value:!0});var Qt=z,Ht=H;function Yt(t,e){return Qt.interpolatePath(t.map(function(r){return new Ht.Path(r)}),e||{})}ie.interpolate=Yt;Object.defineProperty(ae,"__esModule",{value:!0});var Kt=ie;ae.interpolate=Kt.interpolate;var Zt=H,Jt=ae.Path=Zt.Path;const j={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,easeInCubic:t=>t*t*t,easeOutCubic:t=>--t*t*t+1,easeInOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1- --t*t*t*t,easeInOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1+--t*t*t*t*t,easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-t*t),easeOutCirc:t=>Math.sqrt(1- --t*t),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>t*t*((1.70158+1)*t-1.70158),easeOutBack:t=>--t*t*((1.70158+1)*t+1.70158)+1,easeInOutBack:t=>{const e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)},easeInElastic:t=>{if(t===0)return 0;if(t===1)return 1;const e=.3,r=e/(2*Math.PI)*Math.asin(1);return-(Math.pow(2,10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/e))},easeOutElastic:t=>{if(t===0)return 0;if(t===1)return 1;const e=.3,r=e/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*t)*Math.sin((t-r)*(2*Math.PI)/e)+1},easeInOutElastic:t=>{if(t===0)return 0;if((t*=2)===2)return 1;const e=.3*1.5,r=e/(2*Math.PI)*Math.asin(1);return t<1?-.5*(Math.pow(2,10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/e)):Math.pow(2,-10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/e)*.5+1},easeOutBounce:t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,easeInBounce:t=>1-j.easeOutBounce(1-t),easeInOutBounce:t=>t<.5?(1-j.easeOutBounce(1-2*t))/2:(1+j.easeOutBounce(2*t-1))/2},Re="M-703.8092941984535 -63.90098386146127 C-704.0763520597816 -64.41465948657691, -704.4180525933509 -62.04943193707276, -704.6104677824378 -65.44201073680819 C-704.8028829715247 -68.83458953654362, -705.1013435512815 -78.97456875285403, -704.9637853329749 -84.25645665987383 C-704.8262271146683 -89.53834456689364, -704.589649678056 -92.25655284020733, -703.7851184725982 -97.13333817892703 C-702.9805872671404 -102.01012351764673, -701.9583551113512 -107.45010323371551, -700.1365981002284 -113.51716869219206 C-698.3148410891056 -119.5842341506686, -695.8465710937803 -126.38978672762848, -692.854576405861 -133.53573092978633 C-689.8625817179418 -140.6816751319442, -686.2740402853385 -148.63827476272067, -682.1846299727131 -156.39283390513918 C-678.0952196600877 -164.1473930475577, -673.4873271054563 -172.05990209352422, -668.3181145301085 -180.06308578429736 C-663.1489019547606 -188.0662694750705, -657.3197817827187 -196.40057192323476, -651.1693545206261 -204.41193604977798 C-645.0189272585336 -212.4233001763212, -638.3490835573479 -220.37131437072378, -631.415550957553 -228.13127054355664 C-624.4820183577582 -235.8912267163895, -617.6357763947518 -243.39760651050042, -609.568158921857 -250.97167308677507 C-601.5005414489623 -258.5457396630497, -593.0586479967965 -266.03286008526703, -583.0098461201843 -273.57567000120446 C-572.9610442435721 -281.1184799171419, -561.662819416665 -289.023955061226, -549.275347662184 -296.2285325823996 C-536.887875907703 -303.43311010357326, -522.679438253175 -310.71836744796565, -508.6850155932983 -316.80313512824614 C-494.6905929334216 -322.88790280852663, -479.35297948974716 -328.3719341366817, -465.3088117029238 -332.7371386640825 C-451.2646439161004 -337.1023431914833, -437.48954127048455 -340.44736671466114, -424.42000887235804 -342.99436229265086 C-411.3504764742315 -345.5413578706406, -398.59397240096337 -347.44242251563657, -386.8916173141647 -348.0191121320209 C-375.18926222736604 -348.5958017484052, -364.27089364708365 -348.65249596885496, -354.20587835156607 -346.45449999095683 C-344.1408630560485 -344.2565040130587, -334.66563656594394 -341.6348563572863, -326.5015255410593 -334.8311362646323 C-318.3374145161747 -328.02741617197825, -310.80835036510854 -318.96869010201686, -305.22121220225824 -305.63217943503264 C-299.63407403940795 -292.2956687680484, -295.1296754834034 -274.0727397265082, -292.97869656395756 -254.81207226272704 C-290.8277176445117 -235.55140479894587, -290.2925601460474 -213.33362143707544, -292.31533868558313 -190.06817465234565 C-294.3381172251189 -166.80272786761586, -297.16983442204815 -145.93497563136975, -305.11536780117217 -115.21939155434825 C-313.0609011802962 -84.50380747732675, -329.51339504426795 -37.593181021039825, -339.98853896032733 -5.774670190216625 C-350.4636828763867 26.04384064060658, -351.079046147025 29.207456773529394, -367.96623129752857 75.69167343059098 C-384.85341644803214 122.17589008765256, -427.2363685319144 234.11218776004432, -441.31164986334886 273.1306297521529 C-455.3869311947833 312.1490717442615, -450.10622668785544 301.2794805293817, -452.4179192861354 309.80232538324253 C-454.7296118844153 318.32517023710335, -454.3099058166018 317.87991486777304, -455.1818054530284 324.26769887531793 C-456.053705089455 330.6554828828628, -457.308736407731 342.5624552154656, -457.64931710469466 348.1290294285118 C-457.98989780165834 353.69560364155797, -457.62850217241186 354.70066401384463, -457.22528963481034 357.6671441535949 C-456.8220770972088 360.6336242933452, -456.1133711865135 363.3925209702384, -455.23004187908555 365.9279102670133 C-454.3467125716576 368.4632995637882, -453.40355912145003 370.7653368282367, -451.92531379024257 372.87947993424416 C-450.4470684590351 374.99362304025163, -449.1342326330902 376.9119277067065, -446.36056989184067 378.61276890305805 C-443.5869071505911 380.31361009940963, -440.27353331537614 382.24739647534966, -435.2833373427453 383.0845271123536 C-430.2931413701145 383.92165774935756, -423.99338118227763 385.1756541051118, -416.4193940560557 383.6355527250819 C-408.84540692983376 382.09545134505197, -400.18780026766626 380.49699344255913, -389.8394145854138 373.84391883217404 C-379.49102890316135 367.19084422178895, -366.7271903481065 356.97504588115737, -354.3290799625411 343.71710506277145 C-341.93096957697566 330.45916424438553, -328.02327777004115 313.15935123316063, -315.4507522720214 294.2962739218584 C-302.8782267740017 275.4331966105562, -299.6032950975076 271.92757046841484, -278.8939269744227 230.53864119495813 C-258.1845588513378 189.14971192150145, -210.612014359554 84.5401469506534, -191.19454353351193 45.962698281118264 C-171.77707270746987 7.385249611583141, -172.82768426835023 13.463923649880684, -162.38910201817032 -0.9260508222525914 C-151.95051976799041 -15.316025294385867, -140.7072099029987 -28.680409220967654, -128.56305003243256 -40.37714855168139 C-116.4188901618664 -52.07388788239512, -101.8685033637267 -62.39528919532237, -89.52414279477341 -71.10648680653497 C-77.17978222582012 -79.81768441774757, -64.94221522803493 -86.81044369577968, -54.49688661871278 -92.644334218957 C-44.051558009390625 -98.47822474213432, -35.59125091371175 -102.45138642424112, -26.852171138840504 -106.10982994559885 C-18.11309136396926 -109.76827346695657, -10.099254332034263 -112.33228457336881, -2.062407969485321 -114.59499534710335 C5.974438393063622 -116.85770612083789, 13.778665594653223 -118.35943796852386, 21.36890703645315 -119.68609458800609 C28.95914847825308 -121.01275120748831, 36.07159511887784 -122.31150832247233, 43.479040681314245 -122.55493506399665 C50.88648624375065 -122.79836180552097, 58.600164453424476 -122.190493027696, 65.8135804110716 -121.14665503715202 C73.02699636871871 -120.10281704660804, 80.33368736817692 -118.51967688744004, 86.75953642719696 -116.29190712073279 C93.185385486217 -114.06413735402553, 98.80493389257356 -111.23854016084813, 104.36867476519183 -107.78003643690846 C109.9324156378101 -104.32153271296879, 115.4822212636534 -100.18281664479878, 120.14198166290657 -95.54088477709473 C124.80174206215975 -90.89895290939069, 128.67563521072643 -85.6822269705928, 132.32723716071087 -79.92844523068419 C135.9788391106953 -74.17466349077559, 139.18500057953824 -67.76671435858289, 142.05159336281326 -61.01819433764308 C144.9181861460883 -54.26967431670328, 147.35247796795213 -46.656771225783096, 149.52679386036107 -39.437325105045375 C151.70110975277 -32.21787898430765, 151.80143767738295 -32.070156852505384, 155.09748871726697 -17.701517613216765 C158.393539757151 -3.332878373928148, 165.78064471942545 32.14925188353558, 169.30310009966524 46.774510330686326 C172.82555547990503 61.399768777837075, 173.38853041786777 62.502151228319065, 176.23222099870577 70.05003306968774 C179.07591157954377 77.59791491105642, 182.40067555656321 85.38474304293419, 186.3652435846932 92.0618013788984 C190.32981161282316 98.7388597148626, 194.90861454658375 104.94763139115173, 200.01962916748562 110.11238308547297 C205.1306437883875 115.27713477979421, 210.5930844384591 119.5741174197281, 217.0313313101044 123.05031154482583 C223.4695781817497 126.52650566992357, 230.64190804813268 129.55212801105284, 238.6491103973574 130.9695478360594 C246.6563127465821 132.38696766106597, 255.6316747474162 133.2377934006989, 265.0745454054527 131.5548304948652 C274.5174160634892 129.8718675890315, 284.47720533318744 126.6411242863917, 295.30633434557626 120.87177040105723 C306.1354633579651 115.10241651572277, 317.6476041683253 107.1729355651965, 330.0493194797857 96.93870718285837 C342.4510347912461 86.70447880052023, 342.2475031865511 88.74600615955677, 369.7166262143387 59.46640010702845 C397.1857492421263 30.186794054500126, 468.5957053881921 -50.12593336685471, 494.86405764651136 -78.73892913231157 C521.1324099048306 -107.35192489776843, 517.2486716576236 -102.29287070070397, 527.3267397642544 -112.21157448571267 C537.4048078708852 -122.13027827072138, 545.3492916395207 -129.3619233255413, 555.3324662862963 -138.25115184236375 C565.3156409330718 -147.1403803591862, 577.1832734469696 -158.00997752113406, 587.2257876449078 -165.54694558664733 C597.268301842846 -173.0839136521606, 606.1336301975864 -177.49762201917804, 615.5875514739257 -183.4729602354434";let be={sunAngle:0};const er={fragmentShader:`in vec2 vUv;
out vec4 fragColor;
uniform sampler2D u_texture;
uniform float u_progress;

void main() {
  vec4 color = texture(u_texture, vUv);
  // Add a slight red enhancement
  color.r = min(1.0, color.r * (1.0 + 0.2 * u_progress));
  fragColor = color;
}`,uniforms:{u_texture:null,u_progress:0}};class tr extends te{constructor(){super(...arguments);f(this,"passes",0)}setupLayers(){const r=ee(this.canvas),a=[this.width,this.height],{render:n,renderTargets:s}=r.add({fragmentShader:`
        uniform sampler2D surfaceTexture;
        uniform vec2 resolution;
        out vec4 FragColor;

        in vec2 vUv;

        void main() {
          float alpha = texelFetch(surfaceTexture, ivec2(gl_FragCoord.x, gl_FragCoord.y), 0).a;
          FragColor = vec4(vUv * round(alpha), 0.0, 1.0);
        }`,uniforms:{resolution:a,surfaceTexture:null}},{internalFormat:r.gl().RGBA32F,format:r.gl().RGBA,type:r.gl().FLOAT});this.passes=Math.ceil(Math.log2(Math.max(this.width,this.height)))+1;const{render:i,renderTargets:o,uniforms:l}=r.add({fragmentShader:`
uniform vec2 oneOverSize;
uniform vec2 resolution;
uniform sampler2D inputTexture;
uniform float uOffset;
uniform int direction;
uniform bool skip;
uniform int passes;

const int MAX_TILE_SIZE = 32;

const float SQRT_2 = 1.41;

in vec2 vUv;
out vec4 FragColor;

void classic() {
  if (skip) {
    FragColor = vec4(vUv, 0.0, 1.0);
  } else {
    vec2 nearestSeed = vec2(-1.0);
    float nearestDist = 999999.9;
    vec2 pre = uOffset * oneOverSize;

    // Start with the center to try to appeal to loading in a block
    vec2 sampleUV = vUv;

    // Check if the sample is within bounds
    vec2 sampleValue = texture(inputTexture, sampleUV).xy;
    vec2 sampleSeed = sampleValue.xy;

    if (sampleSeed.x > 0.0 || sampleSeed.y > 0.0) {
      vec2 diff = sampleSeed - vUv;
      float dist = dot(diff, diff);
      if (dist < nearestDist) {
        nearestDist = dist;
        nearestSeed.xy = sampleValue.xy;
      }
    }

    // Then do the rest
    for (float y = -1.0; y <= 1.0; y += 1.0) {
      for (float x = -1.0; x <= 1.0; x += 1.0) {
        if (x == 0.0 && y == 0.0) { continue; }
        vec2 sampleUV = vUv + vec2(x, y) * pre;

        // Check if the sample is within bounds
        if (sampleUV.x < 0.0 || sampleUV.x > 1.0 || sampleUV.y < 0.0 || sampleUV.y > 1.0) { continue; }

          vec2 sampleValue = texture(inputTexture, sampleUV).xy;
          vec2 sampleSeed = sampleValue.xy;

          if (sampleSeed.x > 0.0 || sampleSeed.y > 0.0) {
            vec2 diff = sampleSeed - vUv;
            float dist = dot(diff, diff);
            if (dist < nearestDist) {
              nearestDist = dist;
              nearestSeed.xy = sampleValue.xy;
            }
          }
      }
    }

    FragColor = vec4(nearestSeed, 0.0, 1.0);
  }
}

void main() {
  classic();
}`,uniforms:{inputTexture:null,resolution:[this.width,this.height],oneOverSize:[1/this.width,1/this.height],uOffset:Math.pow(2,this.passes-1),direction:0,passes:this.passes,skip:!0}},{internalFormat:r.gl().RGBA32F,format:r.gl().RGBA,type:r.gl().FLOAT}),{render:u,renderTargets:c}=r.add({uniforms:{resolution:[this.width,this.height],jfaTexture:null,surfaceTexture:null},fragmentShader:`
        uniform sampler2D jfaTexture;
        uniform sampler2D surfaceTexture;
        uniform vec2 resolution;

        in vec2 vUv;
        out vec4 FragColor;

        void main() {
          ivec2 texel = ivec2(vUv.x * resolution.x, vUv.y * resolution.y);
          vec2 nearestSeed = texelFetch(jfaTexture, texel, 0).xy;
          float dist = clamp(distance(vUv, nearestSeed), 0.0, 1.0);

          // Normalize and visualize the distance
          FragColor = vec4(dist, 0.0, 0.0, 1.0);
        }`}),{render:h}=r.add({uniforms:{resolution:[this.width,this.height],oneOverSize:[1/this.width,1/this.height],sceneTexture:null,distanceTexture:null,rayCount:32,maxSteps:80,sunAngle:.4,enableSun:!0,showGrain:!1,showNoise:!0,srgb:2.2},fragmentShader:`
uniform int rayCount;
uniform float sunAngle;
uniform bool showNoise;
uniform bool showGrain;
uniform bool enableSun;
uniform vec2 oneOverSize;
uniform int maxSteps;

uniform sampler2D sceneTexture;
uniform sampler2D distanceTexture;

out vec4 FragColor;
in vec2 vUv;

const float PI = 3.14159265;
const float TAU = 2.0 * PI;
const float ONE_OVER_TAU = 1.0 / TAU;
const float PAD_ANGLE = 0.01;
const float EPS = 0.001f;

const vec3 skyColor = vec3(0.02, 0.08, 0.2);
const vec3 sunColor = vec3(0.95, 0.95, 0.9);
const float goldenAngle = PI * 0.7639320225;

// Popular rand function
float rand(vec2 co) {
    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 sunAndSky(float rayAngle) {
    // Get the sun / ray relative angle
    float angleToSun = mod(rayAngle - sunAngle, TAU);

    // Sun falloff based on the angle
    float sunIntensity = smoothstep(1.0, 0.0, angleToSun);

    // And that's our sky radiance
    return sunColor * sunIntensity + skyColor;
}

bool outOfBounds(vec2 uv) {
    return uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0;
}

void main() {
    vec2 uv = vUv;

    vec4 light = texture(sceneTexture, uv);

    vec4 radiance = vec4(0.0);

    float oneOverRayCount = 1.0 / float(rayCount);
    float angleStepSize = TAU * oneOverRayCount;

    float coef = 0.0;
    float offset = showNoise ? rand(uv + coef) : 0.0;
    float rayAngleStepSize = showGrain ? angleStepSize + offset * TAU : angleStepSize;
    float minStepSize = min(oneOverSize.x, oneOverSize.y);

    // Not light source or occluder
    if (light.a < 0.1) {
        // Shoot rays in "rayCount" directions, equally spaced, with some randomness.
        for(int i = 0; i < rayCount; i++) {
            float angle = rayAngleStepSize * (float(i) + offset) + sunAngle;
            vec2 rayDirection = vec2(cos(angle), -sin(angle));

            vec2 sampleUv = uv;
            vec4 radDelta = vec4(0.0);
            bool hitSurface = false;

            // We tested uv already (we know we aren't an object), so skip step 0.
            for (int step = 1; step < maxSteps; step++) {
                // How far away is the nearest object?
                float dist = texture(distanceTexture, sampleUv).r;

                // Go the direction we're traveling (with noise)
                sampleUv += rayDirection * dist;

                if (outOfBounds(sampleUv)) break;

                if (dist <= minStepSize) {
                    vec4 sampleColor = texture(sceneTexture, sampleUv);
                    radDelta += sampleColor;
                    hitSurface = true;
                    break;
                }
            }

            // If we didn't find an object, add some sky + sun color
            if (!hitSurface && enableSun) {
                radDelta += vec4(sunAndSky(angle), 1.0);
            }

            // Accumulate total radiance
            radiance += radDelta;
        }
    } else if (length(light.rgb) >= 0.1) {
        radiance = light;
    }


    // Bring up all the values to have an alpha of 1.0.
    vec4 finalRadiance = vec4(max(light, radiance * oneOverRayCount).rgb, 1.0);
    FragColor = finalRadiance;
}`},{}),d={name:"curve-layer",render:(T,S)=>{n({renderTarget:s[0],uniforms:{surfaceTexture:T}});let R=s[0].texture,[b,E]=o,y=b,w=l.passes;for(let D=0;D<w||w===0&&D===0;D++){const L=Math.pow(2,w-D-1);i({renderTarget:y,uniforms:{skip:w===0,inputTexture:R,uOffset:L,direction:0}}),R=y.texture,y=y===b?E:b}u({renderTarget:c[0],uniforms:{jfaTexture:y.texture,surfaceTexture:T}}),h({uniforms:{distanceTexture:c[0].texture,sceneTexture:T,sunAngle:be.sunAngle}})}},m={name:"seed-layer",render:(T,S)=>{n({uniforms:{surfaceTexture:T}})},x:this.width*.25,y:this.height*.125,width:this.width*.125,height:this.height*.75,isSubview:!0,renderWhenScrubbing:!0},p={name:"jfa-layer",render:(T,S)=>{n({renderTarget:s[0],uniforms:{surfaceTexture:T}});let R=s[0].texture,[b,E]=o,y=b,w=l.passes;for(let D=0;D<w||w===0&&D===0;D++){const L=Math.pow(2,w-D-1);i({renderTarget:y,uniforms:{skip:w===0,inputTexture:R,uOffset:L,direction:0}}),R=y.texture,y=y===b?E:b}i()},x:this.width*.25,y:this.height*.125,width:this.width*.125,height:this.height*.75,isSubview:!0,renderWhenScrubbing:!0},g={name:"df-layer",render:(T,S)=>{n({renderTarget:s[0],uniforms:{surfaceTexture:T}});let R=s[0].texture,[b,E]=o,y=b,w=l.passes;for(let D=0;D<w||w===0&&D===0;D++){const L=Math.pow(2,w-D-1);i({renderTarget:y,uniforms:{skip:w===0,inputTexture:R,uOffset:L,direction:0}}),R=y.texture,y=y===b?E:b}u({uniforms:{jfaTexture:y.texture,surfaceTexture:T}})},x:this.width*.25,y:this.height*.125,width:this.width*.125,height:this.height*.75,isSubview:!0,renderWhenScrubbing:!0},A=ee(this.canvas).add(er),O={name:"polygon-layer",render:(T,S)=>{A.render({uniforms:{u_texture:T,u_progress:S}})}};this.pushLayer(d),this.pushLayer(m),this.pushLayer(p),this.pushLayer(g),this.pushLayer(O)}*animationSequence(){const{width:r,height:a}=this.canvas;yield this.animate([{layer:"background",draw(i,o){i.fillStyle="#181818",i.fillRect(0,0,r,a)}}],{duration:0});const n=this.canvas.width/2,s=this.canvas.height/2;yield this.animate([{layer:["curve-layer","seed-layer","jfa-layer","df-layer"],draw(i,o,l){l.layers["seed-layer"].x=r*.125+o*r*.25,l.layers["jfa-layer"].x=r*.25+o*r*.25,l.layers["df-layer"].x=r*.375+o*r*.25,i.save(),i.translate(n,s),i.scale(r/1920,a/1080);const c=new Jt(Re).getData()[0].length*8,h=new Path2D(Re);i.strokeStyle="#3498db",i.lineWidth=8,i.setLineDash([o*c,c]),i.lineDashOffset=0,i.lineWidth=16,i.lineCap="round",i.lineJoin="round",i.stroke(h),i.restore()}}],{duration:2,easing:j.easeInOutCubic,delay:0}),yield this.animate([{layer:"curve-layer",draw(i,o,l){be.sunAngle=o*2*3.14,l.layers["seed-layer"].height=o===0?a*.75:(1-o)*(a*.75),l.layers["jfa-layer"].height=o===0?a*.75:(1-o)*(a*.75),l.layers["jfa-layer"].y=o===0?a*.125:a*.5-(1-o)*(a*.75)/2;const u=a*.75,c=o===0?u:(1-o)*u;l.layers["df-layer"].height=c,l.layers["df-layer"].y=a*.125+(u-c)}}],{duration:1,easing:j.easeInOutCubic})}}const{FFmpeg:rr}=window.FFmpegWASM,B=new rr;document.addEventListener("DOMContentLoaded",async()=>{await B.load({coreURL:"/libs/ffmpeg/ffmpeg-core.js",wasmURL:"/libs/ffmpeg/ffmpeg-core.wasm"}),console.log("FFmpeg loaded")});async function Se(t,e={}){const{framerate:r=60,codec:a="libx264",outputFile:n="out.mp4",onProgress:s}=e,i=t.getDuration(),o=[],l=1/r;for(let g=0;g<=i+l;g+=l)o.push(g);const u=t.playing();t.pause(),t.seekToTime(0);const c=1/o.length;for(let g=0;g<o.length;g++){t.renderAtTime(o[g]);const _=await new Promise(O=>t.canvas.toBlob(T=>{O(T)})),A=`frame_${g.toString().padStart(6,"0")}.png`;B.writeFile(A,new Uint8Array(await _.arrayBuffer())),s&&s(.3*(g*c))}s&&s(.3),B.on("progress",({progress:g})=>{if(s){const _=.3+g*.7;s(_)}}),B.on("log",g=>{console.log(`ffmpeg log: ${JSON.stringify(g)}`)}),await B.exec(["-framerate",String(r),"-pattern_type","glob","-i","*.png","-c:v",a,"-preset","medium","-pix_fmt","yuv420p","-crf","18",n]),s&&s(.9);const h=await B.readFile(n),d=new Blob([h.buffer],{type:"video/mp4"}),m=URL.createObjectURL(d),p=document.createElement("a");p.href=m,p.download=n,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(m),u&&t.play(),s&&s(1)}class ar{constructor(){f(this,"scene");f(this,"playPauseButton",null);f(this,"scrubber",null);f(this,"timeDisplay",null);f(this,"renderButton",null);f(this,"progressContainer",null);f(this,"progressBar",null);f(this,"isPlaying",!0);f(this,"isDragging",!1);f(this,"wasPlayingBeforeDrag",!1);f(this,"isRendering",!1);f(this,"updateScrubber",()=>{if(!this.isDragging&&this.scrubber&&this.scene){const e=this.scene.getCurrentTime(),r=this.scene.getDuration();if(r>0){const a=Math.min(Math.floor(e/r*1e3),1e3);this.scrubber.value=a.toString(),this.updateTimeDisplay(e,r),e>=r&&this.isPlaying&&(this.isPlaying=!1,this.playPauseButton&&(this.playPauseButton.textContent=""))}}requestAnimationFrame(this.updateScrubber)})}setScene(e){this.scene=e}async initialize(e){if(!this.scene)throw Error("Can't initialize without a scene.");if(this.setupControls(e),this.scene){await this.scene.runSequence();const r=this.scene.getDuration(),a=this.scene.getCurrentTime();this.updateTimeDisplay(a,r),this.isPlaying=this.scene.playing(),this.playPauseButton&&(this.playPauseButton.textContent=this.isPlaying?"":"")}this.updateScrubber(),window.mation=this,window.render=async()=>{this.scene?await Se(this.scene):console.error("No scene available to render")}}setupControls(e){const r=document.createElement("div");r.className="animation-controls",e.appendChild(r),this.playPauseButton=document.createElement("button"),this.playPauseButton.className="play-pause-button",this.playPauseButton.textContent="",r.appendChild(this.playPauseButton);const a=document.createElement("div");a.className="scrubber-container",r.appendChild(a),this.timeDisplay=document.createElement("div"),this.timeDisplay.className="time-display",this.timeDisplay.textContent="0.00 / 0.00",a.appendChild(this.timeDisplay),this.scrubber=document.createElement("input"),this.scrubber.type="range",this.scrubber.min="0",this.scrubber.max="1000",this.scrubber.value="0",this.scrubber.className="scrubber",a.appendChild(this.scrubber),this.renderButton=document.createElement("button"),this.renderButton.className="render-button",this.renderButton.textContent="Render Video",e.appendChild(this.renderButton),this.progressContainer=document.createElement("div"),this.progressContainer.className="progress-container",e.appendChild(this.progressContainer),this.progressBar=document.createElement("div"),this.progressBar.className="progress-bar",this.progressContainer.appendChild(this.progressBar),this.setupEventListeners()}setupEventListeners(){var e,r,a,n,s;(e=this.playPauseButton)==null||e.addEventListener("click",()=>{this.scene&&(this.isPlaying?(this.scene.pause(),this.playPauseButton&&(this.playPauseButton.textContent="")):(this.scene.getCurrentTime()>=this.scene.getDuration()&&this.scene.seekToTime(0),this.scene.play(),this.playPauseButton&&(this.playPauseButton.textContent="")),this.isPlaying=!this.isPlaying)}),(r=this.scrubber)==null||r.addEventListener("mousedown",()=>{this.scene&&(this.isDragging=!0,this.wasPlayingBeforeDrag=this.isPlaying,this.scene.pause(),this.scene.setForceDefaultLayerOnly(!0))}),(a=this.scrubber)==null||a.addEventListener("touchstart",()=>{this.scene&&(this.isDragging=!0,this.wasPlayingBeforeDrag=this.isPlaying,this.scene.pause(),this.scene.setForceDefaultLayerOnly(!0))}),document.addEventListener("mouseup",()=>{this.scene&&this.isDragging&&(this.isDragging=!1,this.scene.setForceDefaultLayerOnly(!1),this.wasPlayingBeforeDrag&&(this.scene.play(),this.isPlaying=!0,this.playPauseButton&&(this.playPauseButton.textContent="")))}),document.addEventListener("touchend",()=>{this.scene&&this.isDragging&&(this.isDragging=!1,this.scene.setForceDefaultLayerOnly(!1),this.wasPlayingBeforeDrag&&(this.scene.play(),this.isPlaying=!0,this.playPauseButton&&(this.playPauseButton.textContent="")))}),(n=this.scrubber)==null||n.addEventListener("input",()=>{if(!this.scene||!this.scrubber)return;const i=parseInt(this.scrubber.value,10),o=this.scene.getDuration(),l=i/1e3*o;this.scene.seekToTime(l),this.updateTimeDisplay(l,o)}),(s=this.renderButton)==null||s.addEventListener("click",async()=>{if(!(!this.scene||this.isRendering||!this.renderButton||!this.progressContainer||!this.progressBar)){this.isRendering=!0,this.renderButton.disabled=!0,this.renderButton.textContent="Rendering...",this.progressContainer.classList.add("visible"),this.progressBar.style.width="0%";try{await Se(this.scene,{onProgress:i=>{this.progressBar&&(this.progressBar.style.width=`${i*100}%`)}}),this.renderButton&&(this.renderButton.textContent="Render Complete!"),setTimeout(()=>{this.renderButton&&(this.renderButton.textContent="Render Video",this.renderButton.disabled=!1),this.progressContainer&&this.progressContainer.classList.remove("visible")},3e3)}catch(i){console.error("Rendering failed:",i),this.renderButton&&(this.renderButton.textContent="Render Failed"),setTimeout(()=>{this.renderButton&&(this.renderButton.textContent="Render Video",this.renderButton.disabled=!1),this.progressContainer&&this.progressContainer.classList.remove("visible")},3e3)}this.isRendering=!1}})}updateTimeDisplay(e,r){this.timeDisplay&&(this.timeDisplay.textContent=`${e.toFixed(2)}s / ${r.toFixed(2)}s`)}}document.addEventListener("DOMContentLoaded",async()=>{const t=document.querySelector("#preview");if(!t)return;const e=document.createElement("canvas");t.append(e);const r=new ar,a=new tr({width:1920,height:1080,canvas:e});r.setScene(a),await r.initialize(t)});
